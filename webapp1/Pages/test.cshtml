@page
@model testModel

<h2>Questions</h2>
<p>Choose each option once for each question.</p>

<form method="post">
    <ol>
        @for (int i = 0; i < Model.Questions.Count; i++)
        {
            var q = Model.Questions[i];
            <div class="mb-4">
                <p><strong>@(i + 1). @q.Content</strong></p>
                <div class="d-flex justify-content-between text-center w-100">
                    @foreach (var option in new[] { "Disagree", "Slightly disagree", "Neutral", "Slightly agree", "Agree" })
                    {
                        <div class="flex-fill">
                            <input type="radio" id="q@i-@option" name="Ratings[@i]" value="@GetRating(option)" required />
                            <label for="q@i-@option">@option</label>
                        </div>
                    }
                </div>
            </div>
        }
    </ol>

    <div class="text-center mt-4">
        <button type="submit" class="btn btn-primary">Submit</button>
    </div>
</form>

@if (!string.IsNullOrEmpty(Model.Message))
{
    <div class="alert alert-info mt-3">@Model.Message</div>
}

@functions {
    private string GetRating(string letter)
    {
        return letter switch
        {
            "Disagree" => "1", // Disagree
            "Slightly disagree" => "2",
            "Neutral" => "3", // Neutral
            "Slightly agree" => "4",
            "Agree" => "5", // Agree
            _ => "0"
        };
    }
}

        @section Scripts {
    <script>
        const shouldPopup = '@TempData["ShowSuccess"]' === 'True';
        if (shouldPopup) {
            alert("✅ Done!");
            window.location.href = "/Main";
        }
    </script>
}
